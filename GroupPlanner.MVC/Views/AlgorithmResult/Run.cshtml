@model GroupPlanner.Application.AlgorithmResult.AlgorithmRunViewModel

@{
    ViewData["Title"] = "Run Algorithm";
}

<h2 class="mb-4">Run Algorithm</h2>

<form id="run-form" asp-action="Run" method="post" novalidate>
    <div class="card mb-4 p-3">
        <div class="form-group row">
            <label for="algorithmSelect" class="col-sm-3 col-form-label fw-bold">Algorithm Type</label>
            <div class="col-sm-9">
                <select asp-for="AlgorithmType" class="form-select" id="algorithmSelect">
                    <option value="Genetic">Genetic Algorithm</option>
                    <option value="Ant">Ant Colony Algorithm</option>
                </select>
                <span asp-validation-for="AlgorithmType" class="text-danger"></span>
            </div>
        </div>
    </div>

    <div id="geneticParams" class="card mb-4 p-3">
        <h4 class="mb-3">Genetic Algorithm Parameters</h4>

        <div class="form-group row mb-2">
            <label for="PopulationSize" class="col-sm-4 col-form-label">Population Size</label>
            <div class="col-sm-8">
                <input asp-for="PopulationSize" type="number" class="form-control" />
                <span asp-validation-for="PopulationSize" class="text-danger"></span>
            </div>
        </div>

        <div class="form-group row mb-2">
            <label for="Generations" class="col-sm-4 col-form-label">Generations</label>
            <div class="col-sm-8">
                <input asp-for="Generations" type="number" class="form-control" />
                <span asp-validation-for="Generations" class="text-danger"></span>
            </div>
        </div>

        <div class="form-group row mb-2">
            <label for="CrossoverProbability" class="col-sm-4 col-form-label">Crossover Probability</label>
            <div class="col-sm-8">
                <input asp-for="CrossoverProbability" type="number" step="0.01" class="form-control" />
                <span asp-validation-for="CrossoverProbability" class="text-danger"></span>
            </div>
        </div>

        <div class="form-group row mb-2">
            <label for="MutationProbability" class="col-sm-4 col-form-label">Mutation Probability</label>
            <div class="col-sm-8">
                <input asp-for="MutationProbability" type="number" step="0.01" class="form-control" />
                <span asp-validation-for="MutationProbability" class="text-danger"></span>
            </div>
        </div>

        <div class="form-group row">
            <label for="TournamentSize" class="col-sm-4 col-form-label">Tournament Size</label>
            <div class="col-sm-8">
                <input asp-for="TournamentSize" type="number" class="form-control" />
                <span asp-validation-for="TournamentSize" class="text-danger"></span>
            </div>
        </div>
    </div>

    <div id="antParams" class="card mb-4 p-3" style="display:none;">
        <h4 class="mb-3">Ant Colony Algorithm Parameters</h4>

        <div class="form-group row mb-2">
            <label for="AntCount" class="col-sm-4 col-form-label">Number of Ants</label>
            <div class="col-sm-8">
                <input asp-for="AntCount" type="number" class="form-control" />
                <span asp-validation-for="AntCount" class="text-danger"></span>
            </div>
        </div>

        <div class="form-group row mb-2">
            <label for="Iterations" class="col-sm-4 col-form-label">Iterations</label>
            <div class="col-sm-8">
                <input asp-for="Iterations" type="number" class="form-control" />
                <span asp-validation-for="Iterations" class="text-danger"></span>
            </div>
        </div>

        <div class="form-group row mb-2">
            <label for="Alpha" class="col-sm-4 col-form-label">Alpha (pheromone weight)</label>
            <div class="col-sm-8">
                <input asp-for="Alpha" type="number" step="0.1" class="form-control" />
                <span asp-validation-for="Alpha" class="text-danger"></span>
            </div>
        </div>

        <div class="form-group row mb-2">
            <label for="Beta" class="col-sm-4 col-form-label">Beta (heuristic weight)</label>
            <div class="col-sm-8">
                <input asp-for="Beta" type="number" step="0.1" class="form-control" />
                <span asp-validation-for="Beta" class="text-danger"></span>
            </div>
        </div>

        <div class="form-group row mb-2">
            <label for="EvaporationRate" class="col-sm-4 col-form-label">Evaporation Rate</label>
            <div class="col-sm-8">
                <input asp-for="EvaporationRate" type="number" step="0.01" class="form-control" />
                <span asp-validation-for="EvaporationRate" class="text-danger"></span>
            </div>
        </div>

        <div class="form-group row">
            <label for="Q" class="col-sm-4 col-form-label">Q (pheromone deposit)</label>
            <div class="col-sm-8">
                <input asp-for="Q" type="number" class="form-control" />
                <span asp-validation-for="Q" class="text-danger"></span>
            </div>
        </div>
    </div>

    <div class="text-end">
        <button id="run-button" type="submit" class="btn btn-success px-4">Run</button>
    </div>
</form>

<!-- progress bar + result message -->
<div id="loading-section" class="mt-4" style="display:none;">
    <div class="progress mb-2">
        <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated bg-info" style="width: 0%">0%</div>
    </div>
    <p id="statusText" class="text-muted"></p>
    <div id="success-message" class="alert alert-success mt-3 d-none">Algorithm completed successfully!</div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="~/js/AlgorithmResult/algorithmFormToggle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/&#64;microsoft/signalr@7.0.5/dist/browser/signalr.min.js"></script>
    <script src="~/js/AlgorithmResult/algorithmStatus.js"></script>
}
